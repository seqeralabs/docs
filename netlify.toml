[[edge_functions]]
  function = "og-generate.png"
  path = "/og-generate.png"

[build.environment]
  NODE_VERSION = "22"
  NODE_OPTIONS = "--max-old-space-size=4096"
  # Limit SSG worker threads to prevent OOM errors in Netlify builds
  # Docusaurus defaults to 32 threads with 1GB memory each, but Netlify's
  # memory limits aren't properly enforced, causing out-of-memory 137 errors.
  # Limiting thread processing avoids this issue with some build time impact however,
  # build are still significantly faster than without SSG in-use.
  # Reference: https://github.com/facebook/docusaurus/discussions/11199
  DOCUSAURUS_SSG_WORKER_THREAD_COUNT = "1"

[context.deploy-preview.build.environment]
  INCLUDE_NEXT="true"
  EXCLUDE_PLATFORM_API="true"
  EXCLUDE_PLATFORM_OPENAPI="true"

# Asset and image routing handled by Edge Function
# See .netlify/edge-functions/asset-proxy.js
[[edge_functions]]
  function = "asset-proxy"
  path = "/assets/*"

[[edge_functions]]
  function = "asset-proxy"
  path = "/img/*"

[[plugins]]
  package = "netlify-plugin-cache"
  [plugins.inputs]
    paths = [
      "node_modules/.cache",
      ".docusaurus"
    ]
