---
title: "Moab"
description: "Instructions to set up Moab in Nextflow Tower"
date: "21 Apr 2023"
tags: [moab, compute environment]
---

[Moab](http://docs.adaptivecomputing.com/suite/8-0/basic/help.htm#topics/moabWorkloadManager/topics/intro/productOverview.htm) is a scheduling and management system designed for clusters, grids, and on-demand/utility computing systems. At a high level, Moab applies site policies and extensive optimizations to orchestrate jobs, services, and other workloads across the ideal combination of network, compute, and storage resources.

Tower streamlines the deployment of Nextflow pipelines into both cloud-based and on-prem Moab clusters.

## Requirements

To launch pipelines into a **Moab** cluster from Tower, the following requirements must be satisfied:

- The cluster should allow outbound connections to the Tower web service.
- The cluster queue used to run the Nextflow head job must be able to submit cluster jobs.
- The Nextflow runtime version **21.02.0-edge** (or later) must be installed on the cluster.

## Compute environment

To create a new compute environment for **Moab** in Tower:

1.  In a workspace, select **Compute environments** and then **New environment**.

1.  Enter a descriptive name for this environment, e.g., "Moab cluster".

1.  Select **Moab Workload Manager** as the target platform.

1.  Select your credentials, or select **+** and **SSH** or **Tower Agent** to add new credentials.

1.  Enter a name for the credentials.

1.  Enter the absolute path of the **Work directory** to be used on the cluster.

1.  Enter the absolute path of the **Launch directory** to be used on the cluster. If omitted, it will be the same as the work directory.

1.  If using SSH credentials, enter the **Login hostname**. This is usually the hostname or public IP address of the cluster's login node.

1.  Enter the **Head queue name**. This is the cluster queue to which the Nextflow job will be submitted.

1.  Enter the **Compute queue name**. This is the cluster queue to which the Nextflow job will submit tasks.

    :::tip
    The compute queue can be overridden by the Nextflow pipeline configuration. See the Nextflow [documentation](https://www.nextflow.io/docs/latest/process.html#queue) for more details.
    :::

1.  Expand **Staging options** to include optional pre- or post-run Bash scripts that execute before or after the Nextflow pipeline execution in your environment.

1.  Use the **Environment variables** option to specify custom environment variables for the Head job and/or Compute jobs.

1.  Configure any advanced options described below, as needed.

1.  Select **Create** to finalize the creation of the compute environment.

Jump to the documentation for [launching pipelines](../launch/launchpad.mdx).

### Advanced options

- Use the **Nextflow queue size** to limit the number of jobs that Nextflow can submit to the scheduler at the same time.

- Use the **Head job submit options** to specify Moab options for the head job. You can optionally apply these options to compute jobs as well:

  ![](./_images/head_job_propagation.png)
